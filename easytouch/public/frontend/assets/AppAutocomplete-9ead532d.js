var pe=Object.defineProperty,he=Object.defineProperties;var ge=Object.getOwnPropertyDescriptors;var j=Object.getOwnPropertySymbols;var ye=Object.prototype.hasOwnProperty,ke=Object.prototype.propertyIsEnumerable;var H=(e,a,t)=>a in e?pe(e,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[a]=t,w=(e,a)=>{for(var t in a||(a={}))ye.call(a,t)&&H(e,t,a[t]);if(j)for(var t of j(a))ke.call(a,t)&&H(e,t,a[t]);return e},O=(e,a)=>he(e,ge(a));import{b as Ve,V as Ce}from"./VInput-545a0bfa.js";import{m as _e}from"./VSelect-25505b64.js";import{f as we}from"./forwardRefs-bb5e4b03.js";import{m as xe,u as be}from"./filter-a01fa339.js";import{m as Ae}from"./transition-61bfbac1.js";import{u as Ie,V as Se,a as Q}from"./VList-ce82f9df.js";import{J as Pe,U as De,$ as Fe,Y as z,O as Te,a4 as Re,T as Le,az as Me}from"./index-e43e3799.js";import{m as $e,V as Y}from"./VTextField-61b1d2aa.js";import{V as Be}from"./VMenu-e207a306.js";import{V as Ee}from"./VCheckboxBtn-0ece9886.js";import{V as Ne}from"./VChip-c30ae960.js";import{f as x,c as y,d as q,B as G,k as r,M as le,n as P,Q as Ue,h as Oe,ah as W,I as X,L as ze,u as L,J as Ke,T as Je,af as je,N as He,K as Qe,V as Ye,a2 as Z,ag as ee,S as qe}from"./frappe-ui-b8f10d89.js";function Ge(e,a,t){if(a==null)return e;if(Array.isArray(a))throw new Error("Multiple matches is not implemented");return typeof a=="number"&&~a?r(le,null,[r("span",{class:"v-autocomplete__unmask"},[e.substr(0,a)]),r("span",{class:"v-autocomplete__mask"},[e.substr(a,t)]),r("span",{class:"v-autocomplete__unmask"},[e.substr(a+t)])]):e}const We=Pe()({name:"VAutocomplete",props:w(w(w(w({search:String},xe({filterKeys:["title"]})),_e()),De($e({modelValue:null}),["validationValue","dirty","appendInnerIcon"])),Ae({transition:!1})),emits:{"update:focused":e=>!0,"update:search":e=>!0,"update:modelValue":e=>!0,"update:menu":e=>!0},setup(e,a){let{slots:t}=a;const{t:h}=Fe(),d=x(),k=x(!1),f=x(!0),D=x(),M=z(e,"menu"),m=y({get:()=>M.value,set:l=>{var n;M.value&&!l&&((n=D.value)!=null&&n.Î¨openChildren)||(M.value=l)}}),o=x(-1),te=y(()=>{var l;return(l=d.value)==null?void 0:l.color}),{items:$,transformIn:ae,transformOut:ne}=Ie(e),{textColorClasses:ue,textColorStyles:oe}=Te(te),c=z(e,"search",""),g=z(e,"modelValue",[],l=>ae(Re(l)),l=>{var s;const n=ne(l);return e.multiple?n:(s=n[0])!=null?s:null}),b=Ve(),{filteredItems:B,getMatches:se}=be(e,$,y(()=>f.value?void 0:c.value)),V=y(()=>g.value.map(l=>$.value.find(n=>e.valueComparator(n.value,l.value))||l)),E=y(()=>e.hideSelected?B.value.filter(l=>!V.value.some(n=>n.value===l.value)):B.value),N=y(()=>V.value.map(l=>l.props.value)),K=y(()=>V.value[o.value]),U=x();function re(l){e.openOnClear&&(m.value=!0),c.value=""}function ie(){e.hideNoData&&!$.value.length||e.readonly||b!=null&&b.isReadonly.value||(m.value=!0)}function ce(l){var F,u,p,_;if(e.readonly||b!=null&&b.isReadonly.value)return;const n=d.value.selectionStart,s=N.value.length;if((o.value>-1||["Enter","ArrowDown","ArrowUp"].includes(l.key))&&l.preventDefault(),["Enter","ArrowDown"].includes(l.key)&&(m.value=!0),["Escape"].includes(l.key)&&(m.value=!1),["Enter","Escape","Tab"].includes(l.key)&&(f.value=!0),l.key==="ArrowDown"?(F=U.value)==null||F.focus("next"):l.key==="ArrowUp"&&((u=U.value)==null||u.focus("prev")),!!e.multiple){if(["Backspace","Delete"].includes(l.key)){if(o.value<0){l.key==="Backspace"&&!c.value&&(o.value=s-1);return}const i=o.value;K.value&&I(K.value),o.value=i>=s-1?s-2:i}if(l.key==="ArrowLeft"){if(o.value<0&&n>0)return;const i=o.value>-1?o.value-1:s-1;V.value[i]?o.value=i:(o.value=-1,d.value.setSelectionRange((p=c.value)==null?void 0:p.length,(_=c.value)==null?void 0:_.length))}if(l.key==="ArrowRight"){if(o.value<0)return;const i=o.value+1;V.value[i]?o.value=i:(o.value=-1,d.value.setSelectionRange(0,0))}}}function ve(l){c.value=l.target.value}function de(){k.value&&(f.value=!0)}function fe(l){k.value=!0}function me(l){var n;l.relatedTarget==null&&((n=d.value)==null||n.focus())}const A=x(!1);function I(l){if(e.multiple){const n=N.value.findIndex(s=>e.valueComparator(s,l.value));if(n===-1)g.value=[...g.value,l];else{const s=[...g.value];s.splice(n,1),g.value=s}}else g.value=[l],A.value=!0,t.selection||(c.value=l.title),m.value=!1,f.value=!0,G(()=>A.value=!1)}return q(k,l=>{var n,s;l?(A.value=!0,c.value=e.multiple||t.selection?"":String((s=(n=V.value.at(-1))==null?void 0:n.props.title)!=null?s:""),f.value=!0,G(()=>A.value=!1)):(m.value=!1,c.value="")}),q(c,l=>{!k.value||A.value||(l&&(m.value=!0),f.value=!l)}),Le(()=>{const l=!!(e.chips||t.chip),n=!!(!e.hideNoData||E.value.length||t.prepend||t.append||t["no-data"]),s=g.value.length>0,[F]=Y.filterProps(e);return r(Y,P({ref:d},F,{modelValue:c.value,"onUpdate:modelValue":u=>{u==null&&(g.value=[])},focused:k.value,"onUpdate:focused":u=>k.value=u,validationValue:g.externalValue,dirty:s,onInput:ve,class:["v-autocomplete",{"v-autocomplete--active-menu":m.value,"v-autocomplete--chips":!!e.chips,"v-autocomplete--selecting-index":o.value>-1,[`v-autocomplete--${e.multiple?"multiple":"single"}`]:!0,"v-autocomplete--selection-slot":!!t.selection},e.class],style:e.style,appendInnerIcon:e.menuIcon,readonly:e.readonly,placeholder:s?void 0:e.placeholder,"onClick:clear":re,"onMousedown:control":ie,onKeydown:ce}),O(w({},t),{default:()=>r(le,null,[r(Be,P({ref:D,modelValue:m.value,"onUpdate:modelValue":u=>m.value=u,activator:"parent",contentClass:"v-autocomplete__content",eager:e.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,transition:e.transition,onAfterLeave:de},e.menuProps),{default:()=>[n&&r(Se,{ref:U,selected:N.value,selectStrategy:e.multiple?"independent":"single-independent",onMousedown:u=>u.preventDefault(),onFocusin:fe,onFocusout:me},{default:()=>{var u,p,_,i;return[!E.value.length&&!e.hideNoData&&((p=(u=t["no-data"])==null?void 0:u.call(t))!=null?p:r(Q,{title:h(e.noDataText)},null)),(_=t["prepend-item"])==null?void 0:_.call(t),E.value.map(v=>{var S,C;return(C=(S=t.item)==null?void 0:S.call(t,{item:v,props:P(v.props,{onClick:()=>I(v)})}))!=null?C:r(Q,P({key:v.value},v.props,{onClick:()=>I(v)}),{prepend:T=>{let{isSelected:R}=T;return e.multiple&&!e.hideSelected?r(Ee,{modelValue:R,ripple:!1,tabindex:"-1"},null):void 0},title:()=>{var T,R,J;return f.value?v.title:Ge(v.title,(T=se(v))==null?void 0:T.title,(J=(R=c.value)==null?void 0:R.length)!=null?J:0)}})}),(i=t["append-item"])==null?void 0:i.call(t)]}})]}),V.value.map((u,p)=>{var v,S;function _(C){C.stopPropagation(),C.preventDefault(),I(u)}const i={"onClick:close":_,modelValue:!0,"onUpdate:modelValue":void 0};return r("div",{key:u.value,class:["v-autocomplete__selection",p===o.value&&["v-autocomplete__selection--selected",ue.value]],style:p===o.value?oe.value:{}},[l?t.chip?r(Me,{key:"chip-defaults",defaults:{VChip:{closable:e.closableChips,size:"small",text:u.title}}},{default:()=>{var C;return[(C=t.chip)==null?void 0:C.call(t,{item:u,index:p,props:i})]}}):r(Ne,P({key:"chip",closable:e.closableChips,size:"small",text:u.title},i),null):(S=(v=t.selection)==null?void 0:v.call(t,{item:u,index:p}))!=null?S:r("span",{class:"v-autocomplete__selection-text"},[u.title,e.multiple&&p<V.value.length-1&&r("span",{class:"v-autocomplete__selection-comma"},[Ue(",")])])])})])}))}),we({isFocused:k,isPristine:f,menu:m,search:c,filteredItems:B,select:I},d)}}),Xe=Oe({name:"AppAutocomplete",inheritAttrs:!1}),dl=Object.assign(Xe,{setup(e){const a=y(()=>{const h=W(),d=h.id||h.label;return d?`app-autocomplete-${d}-${Math.random().toString(36).slice(2,7)}`:void 0}),t=y(()=>W().label);return(h,d)=>(X(),ze("div",{class:qe(["app-autocomplete flex-grow-1",h.$attrs.class])},[L(t)?(X(),Ke(Ce,{key:0,for:L(a),class:"mb-1 text-body-2 text-high-emphasis",text:L(t)},null,8,["for","text"])):Je("",!0),r(We,Z(ee(O(w({},h.$attrs),{class:null,label:void 0,id:L(a),variant:"outlined",menuProps:{contentClass:["app-inner-list","app-autocomplete__content","v-autocomplete__content"]}}))),je({_:2},[He(h.$slots,(k,f)=>({name:f,fn:Qe(D=>[Ye(h.$slots,f,Z(ee(D||{})))])}))]),1040)],2))}});export{We as V,dl as _};
//# sourceMappingURL=AppAutocomplete-9ead532d.js.map
